
<!doctype html>
<html lang="en" xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/thymeleaf-extras-springsecurity5">

<head th:replace="Fragments/fragment::page_head('Orders','none')"/>

<body>

<!-- header -->
<div th:replace="~{Fragments/header :: header}">...</div>
<!-- //header -->

<!-- inner banner -->
<section class="inner-banner py-5">
  <div class="w3l-breadcrumb py-lg-5">
    <div class="container pt-4 pb-sm-4">
      <h4 class="inner-text-title pt-5">Orders</h4>
      <ul class="breadcrumbs-custom-path">
        <li><a th:href="@{/home}">Dashboard</a></li>
        <li><i class="fas fa-angle-right"></i><a th:href="@{/orders}">Orders</a></li>
        <li class="active"><i class="fas fa-angle-right"></i>Edit Order</li>
      </ul>
    </div>
  </div>
</section>
<!-- //inner banner -->


<section class="w3l-contact py-5" id="contact">
  <div class="container py-md-5 py-4">
    <div class="title-main text-center mx-auto mb-md-5 mb-4" style="max-width:500px;">
      <p class="text-uppercase">Edit Existing Order</p>
      <h3 class="title-style">Order Details</h3>
    </div>
    <div class="row ">
      <div class="col-md contact-right">
        <!-- Nav tabs -->
        <ul class="nav nav-tabs " id="myTab" role="tablist">
          <li class="nav-item">
            <a class="nav-link " data-toggle="tab" href="#overview" role="tab">Overview</a>
          </li>
          <li class="nav-item">
            <a class="nav-link active" data-toggle="tab" href="#products" role="tab">Products</a>
          </li>
          <li class="nav-item">
            <a class="nav-link " data-toggle="tab" href="#shipping" role="tab">Shipping</a>
          </li>
          <li class="nav-item">
            <a class="nav-link " data-toggle="tab" href="#tracking" role="tab">Track</a>
          </li>
        </ul>
        <!-- Tab panes -->
        <div class="tab-content">
          <div class="tab-pane  p-3 " id="overview" role="tabpanel">
            <div class="input-grids product-block">
              <div class="row form-group">
                <label class="col-form-label col-sm-2">Order Id : </label>
                <input type="text" th:value="${order.id}" readonly class=" col-sm-10"/>
              </div>
              <div class="row form-group">
                <label class="col-form-label col-sm-2">Customer : </label>
                <input type="text" readonly th:value="${order.customer.fullName}" class="contact-input col-sm-10"/>
              </div>
              <div class="row form-group">
                <label class="col-form-label col-sm-2">Product Cost : </label>
                <input type="text" readonly th:value="${order.productCost}" id="productCost" class="contact-input col-sm-10"/>
              </div>
              <div class="row form-group">
                <label class="col-form-label col-sm-2">Subtotal : </label>
                <input type="text" readonly th:value="${order.subTotal}" id="subTotal" class="contact-input col-sm-10"/>
              </div>
              <div class="row form-group">
                <label class="col-form-label col-sm-2">Shipping Cost : </label>
                <input type="text" readonly th:value="${order.shippingCost}" id="shippingCost" class="contact-input col-sm-10"/>
              </div>
              <div class="row form-group">
                <label class="col-form-label col-sm-2">Tax : </label>
                <input type="text"  th:value="${order.tax}" id="tax" class="contact-input col-sm-10"/>
              </div>
              <div class="row form-group">
                <label class="col-form-label col-sm-2">Total : </label>
                <input type="text" readonly th:value="${order.total}" id="total" class="contact-input col-sm-10"/>
              </div>
              <div class="row form-group">
                <label class="col-form-label col-sm-2">Payment Method : </label>
                <select th:field="${order.paymentMethod}" class="my-form-control  col-sm-10" >
                  <option th:each="os :${T(com.eShope.common.entity.Order.PaymentMethod).values()}" th:value="${os}" th:text="${os}"/>
                </select>

              </div>
              <div class="row form-group">
                <label class="col-form-label col-sm-2">Status : </label>
                <select th:field="${order.orderStatus}" class="my-form-control  col-sm-10" >
                  <option th:each="os :${T(com.eShope.common.entity.Order.OrderStatus).values()}" th:value="${os}" th:text="${os}"/>
                </select>
              </div>
              <div class="row form-group">
                <label class="col-form-label col-sm-2">Order Date : </label>
                <span type="text" th:text="${order.orderTime}"  class=" col-sm-10"></span>
              </div>

            </div>
          </div>
          <div class="tab-pane p-3 active " id="products" role="tabpanel">
            <div  class="row border rounded p-1 " id="productList">
              <th:block th:each="detail,status:${order.orderDetails}">
              <div class="row  p-3" th:with="product=${detail.product}">
                <div class="col-1">
                  <div class="div-count">[[${status.count}]]</div>
                </div>
                <div class="col-3">
                  <img th:src="@{${product.getMainImagePath}}" class="img-fluid">
                </div>
                <div class="col-8">
                  <div class="text-wrap  align-items-center h-100 d-flex ">
                    <b>[[${product.name}]]</b>
                  </div>
                </div>
                <div class="row">
                  <div class="input-grids product-block m-4">
                    <div class="row form-group">
                      <label class="col-form-label col-sm-2">Product Cost : </label>
                      <input type="text" th:value="${detail.productCost}" th:rowNumber="${status.count}" class=" col-sm-10 cost-input"/>
                    </div>
                    <div class="row form-group">
                      <label class="col-form-label col-sm-2">Quantity : </label>
                      <input type="number" step="1" min="1" th:rowNumber="${status.count}" th:id="'quantity'+${status.count}" max="5" th:value="${detail.quantity}"  class="quantity-input col-sm-10"/>
                    </div>
                    <div class="row form-group">
                      <label class="col-form-label col-sm-2">Unit Price : </label>
                      <input type="text" th:value="${detail.unitPrice}"  th:rowNumber="${status.count}" th:id="'price'+${status.count}" class=" col-sm-10 price-input"/>
                    </div>
                    <div class="row form-group">
                      <label class="col-form-label col-sm-2">Shipping Cost : </label>
                      <input type="text" th:value="${detail.shippingCost}"  class=" col-sm-10 shippingCost-input"/>
                    </div>
                    <div class="row form-group">
                      <label class="col-form-label col-sm-2">Subtotal : </label>
                      <input type="text" th:value="${detail.subTotal}" readonly th:id="'subTotal'+${status.count}" class=" col-sm-10 subTotal-output"/>
                    </div>
                  </div>
                </div>
              </div>
              <hr class="w-75 " style="margin:auto">
            </th:block>
            </div>
          </div>
          <div class="tab-pane p-3 " id="shipping" role="tabpanel">
            <div class="input-grids product-block">
              <div class="row form-group">
                <label class="col-form-label col-sm-2">Deliver Days : </label>
                <input type="text" th:value="${order.deliverDays}"  class=" col-sm-10"/>
              </div>
              <div class="row form-group">
                <label class="col-form-label col-sm-2">Expected Deliver Date : </label>
                <input type="date" th:value="${order.deliverDateOnForm}"  class=" col-sm-10"/>
              </div>
              <div class="row form-group">
                <label class="col-form-label col-sm-2">First Name : </label>
                <input type="text" th:value="${order.firstName}"  class="contact-input col-sm-10"/>
              </div>
              <div class="row form-group">
                <label class="col-form-label col-sm-2">Last Name : </label>
                <input type="text" th:value="${order.lastName}"  class="contact-input col-sm-10"/>
              </div>
              <div class="row form-group">
                <label class="col-form-label col-sm-2">Phone Number : </label>
                <input type="text" th:value="${order.phoneNumber}"  class="contact-input col-sm-10"/>
              </div>
              <div class="row form-group">
                <label class="col-form-label col-sm-2">Address Line 1 : </label>
                <input type="text" th:value="${order.addressLine1}"  class="contact-input col-sm-10"/>
              </div>
              <div class="row form-group">
                <label class="col-form-label col-sm-2">Address Line 2 : </label>
                <input type="text" th:value="${order.addressLine2}"  class=" col-sm-10"/>
              </div>
              <div class="row form-group">
                <label class="col-form-label col-sm-2">City : </label>
                <input type="text" th:value="${order.city}"  class=" col-sm-10"/>
              </div>
              <div class="row form-group">
                <label class="col-form-label col-sm-2">Country : </label>
                <select class="my-form-control  col-sm-10" id="country">
                  <th:block th:each="country:${listCountries}">
                    <option th:value="${country.id}" th:selected="${country.name==order.country}">[[${country.name}]]</option>
                  </th:block>
                </select>
              </div>
              <div class="row form-group">
                <label class="col-form-label col-sm-2">State : </label>
<!--                <input type="text" th:value="${order.state}"  class=" col-sm-10"/>-->
                <input type="text" th:field="${order.state}" placeholder="State" class="contact-input col-sm-10"
                       list="listStates"/>
                <datalist id="listStates"></datalist>
              </div>

              <div class="row form-group">
                <label class="col-form-label col-sm-2">Postal Code : </label>
                <input type="text" th:value="${order.postalCode}"  class=" col-sm-10"/>
              </div>

            </div>
          </div>
          <div class="tab-pane p-3 " id="tracking" role="tabpanel">

          </div>
        </div>

      </div>
    </div>
  </div>
</section>


<div class="col-md-2 login-center text-start">
  <a th:href="@{/home}">
    <button class="btn btn-style btn-style-3 text-left">BACK</button>
  </a>
</div>

<!--    COMMON JAVASCRIPT  -->
<div th:replace="Fragments/fragment::common_JS"></div>
<!--    /COMMON JAVASCRIPT  -->

<script>
    var dropDownCountry;
    var dataListState;
    var fieldState;
    var contextPath="[[@{/}]]";
    $(document).ready(function() {
        dropDownCountry=$("#country");
        dataListState=$("#listStates");
        fieldState=$("#state");

        dropDownCountry.on("change",function(){
            loadStatesForCountry();
           fieldState.val("").focus();
        });
    });

    function loadStatesForCountry(){
        selectedCountry=$("#country option:selected");
        console.log(contextPath);
        countryId=selectedCountry.val();
        url=contextPath+"states/listByCountry/"+countryId;
        console.log(url)

        $.get(url,function(responseJSON){
            dataListState.empty();

            $.each(responseJSON,function(index,state){
                $("<option>").val(state.name).text(state.name).appendTo (dataListState);
            })
        });
    }

</script>
<script th:src="@{/assets/js/jquery.number.min.js}"></script>
<script th:src="@{/assets/js/formatAmountNumber.js}"></script>


</body>
</html>
